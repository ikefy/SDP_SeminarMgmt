<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <title>CHITCHAT | Welcome</title>
        <link rel="stylesheet" href="./assets/css/seminar_style.css">
        <link rel="stylesheet" href="./assets/css/coreui.min.css">
        <link rel="stylesheet" href="./assets/css/coreui-icons.min.css">
    </head>
    <body>
        <script src="./assets/js/jquery-3.3.1.min.js"></script>
        <header>
            <div class="container">
                <div id="branding">
                    <h1 class="hightlight">CHITCHAT</h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li class="current"><a href="seminar_list.html">Seminar</a></li>
                        <li><a href="create_seminar.html">Create Seminar</a></li>
                        <li><a href="index.html">Attendee</a></li>
                    </ul>
                </nav>
            </div>
        </header>
        <section id="middlepart">
            <div class="container">
                <aside id="sidenav">
                    <img src="./assets/img/uts.png">
                    <nav>
                        <ul>
                            <li><a href="index.html">My Seminars</a></li>
                            <li><a href="my_profile.html">My Profile</a></li>
                        </ul>
                    </nav>
                </aside>
                <div class="app-body">
                    <main class="main">
                        <button class="btn btn-outline-success my-2 my-sm-0" type="button" onclick="searchsem1()">All Seminars</button>
                        <button class="btn btn-outline-success my-2 my-sm-0" type="button" onclick="searchsem2('sept')">September</button>
                        <button class="btn btn-outline-success my-2 my-sm-0" type="button" onclick="searchsem2('oct')">October</button>
                        <table id="semtbl" class="table">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Seminar Name</th>
                                    <th scope="col">Venue</th>
                                    <th scope="col">Date</th>
                                </tr>
                            </thead>
                            <tbody>

                            </tbody>
                        </table>
                    </main>
                </div>
            </div>
        </section>
        <footer>
            <p>CHITCHAT Web Design, Copyright &copy; 2017</p>
        </footer>
        <script type='text/javascript'>
            function searchsem1() {
                console.log("start searchsem()");
                var settings = {
                    "async": true,
                    "crossDomain": true,
                    "url": "https://sdp-seminarmgmt.azurewebsites.net/api/seminar/",
                    "method": "GET",
                    "headers": {
                        "cache-control": "no-cache",
                        "postman-token": "3f79c459-fd65-db7e-5d1a-f66cc2ff2cbf"
                    }
                }
                $.ajax(settings).done(function (response) {
                    console.log(response);
                    var seminars = response;
                    var seminar_parse = JSON.parse(seminars);
                    settblvalues(seminar_parse.length, seminar_parse);
                });
            }

            function searchsem2(month) {
                console.log("start searchsem()");
                var settings = {
                    "async": true,
                    "crossDomain": true,
                    "url": "https://sdp-seminarmgmt.azurewebsites.net/api/seminar/daterange/" + month,
                    "method": "GET",
                    "headers": {
                        "cache-control": "no-cache",
                        "postman-token": "3f79c459-fd65-db7e-5d1a-f66cc2ff2cbf"
                    }
                }
                $.ajax(settings).done(function (response) {
                    console.log(response);
                    var seminars = response;
                    var seminar_parse = JSON.parse(seminars);
                    var seminar_length = seminar_parse.length;
                    settblvalues(seminar_parse.length, seminar_parse);
                });
            }

            function settblvalues(x, seminar_parse) {
                console.log(seminar_parse);
                console.log(seminar_parse[0]);
                console.log(seminar_parse[0].RoomID);
                console.log(seminar_parse.length);
                cleartbl()
                createtbl(x);
                setsemtblValues(seminar_parse);
            }

            function cleartbl() {
                var table = document.getElementById("semtbl");
                var rows = document.getElementById("semtbl").getElementsByTagName("tr").length;
                console.log(rows);
                for (var i = 1; i < rows; i++) {
                    table.deleteRow(1);
                }
            }

            function createtbl(x) {
                console.log("cleartbl");
                for (var i = 0; i < x; i++) {
                    //var x = document.getElementById("semtbl").rows[i + 1].cells;
                    //x[0].innerHTML = ".";
                    //x[1].innerHTML = ".";
                    //x[2].innerHTML = ".";
                    //x[3].innerHTML = ".";
                    var table = document.getElementById("semtbl");
                    var row = table.insertRow(i+1);
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
                    var cell1 = row.insertCell(2);
                    var cell2 = row.insertCell(3);
                }
            }

            function setsemtblValues(seminar_parse) {
                console.log("settbl");
                for (var i = 0; i < seminar_parse.length; i++) {
                    var x = document.getElementById("semtbl").rows[i + 1].cells;
                    x[0].innerHTML = seminar_parse[i].SeminarID;
                    //var y = document.getElementById(i);
                    //y.value = seminar_parse[i].SeminarID;
                    x[1].innerHTML = seminar_parse[i].SeminarTitle;
                    x[2].innerHTML = seminar_parse[i].RoomNumber;
                    x[3].innerHTML = seminar_parse[i].SeminarDate;
                }
            }
        </script>
    </body>
</html>